<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mapa Estelar do Nosso Primeiro Beijo</title>
<style>
  body {
    margin: 0;
    background-color: #000;
    color: #ddd;
    font-family: 'Courier New', Courier, monospace;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
  }

  h1 {
    margin-top: 20px;
    font-weight: normal;
    font-size: 2rem;
    text-align: center;
    color: #eee;
  }

  .telescope-view {
    width: 90vw;
    max-width: 600px;
    aspect-ratio: 1 / 1;
    border-radius: 50%;
    overflow: hidden;
    border: 2px solid #888;
    background-color: #111;
    position: relative;
    touch-action: none;
    cursor: grab;
  }
  .telescope-view:active {
    cursor: grabbing;
  }

  .draggable-image {
    position: absolute;
    top: 0;
    left: 0;
    user-select: none;
    -webkit-user-drag: none;
    transform: translate(0px, 0px) scale(1.2); /* zoom proporcional */
    transform-origin: center center;
  }

  #contador {
    margin-top: 20px;
    font-size: 1.2rem;
    color: #ccc;
    text-align: center;
  }

  #contador strong {
    color: #fff;
  }
</style>
</head>
<body>

  <h1>Mapa Estelar do Nosso Primeiro Beijo</h1>

  <div class="telescope-view" id="telescope">
    <img src="./starmap.jpeg" alt="Mapa estelar do nosso primeiro beijo" class="draggable-image" id="draggableImage" />
  </div>

  <div id="contador">Carregando contador...</div>

<script>
  const telescope = document.getElementById('telescope');
  const img = document.getElementById('draggableImage');

  let isDragging = false;
  let startX, startY;
  let currentX = 0;
  let currentY = 0;
  let limits = { minX: 0, maxX: 0, minY: 0, maxY: 0 };
  const zoom = 1.2; // zoom proporcional

  function clamp(value, min, max) {
    return Math.min(Math.max(value, min), max);
  }

  function updateLimits() {
    const containerW = telescope.offsetWidth;
    const containerH = telescope.offsetHeight;
    const imgW = img.naturalWidth * zoom * (containerH / img.naturalHeight);
    const imgH = containerH * zoom;

    return {
      minX: containerW - imgW,
      maxX: 0,
      minY: containerH - imgH,
      maxY: 0
    };
  }

  function onPointerDown(e) {
    e.preventDefault();
    isDragging = true;
    startX = e.clientX || e.touches[0].clientX;
    startY = e.clientY || e.touches[0].clientY;
    telescope.style.cursor = 'grabbing';
  }

  function onPointerMove(e) {
    if (!isDragging) return;
    e.preventDefault();
    const x = e.clientX || e.touches[0].clientX;
    const y = e.clientY || e.touches[0].clientY;

    let deltaX = x - startX;
    let deltaY = y - startY;

    let nextX = clamp(currentX + deltaX, limits.minX, limits.maxX);
    let nextY = clamp(currentY + deltaY, limits.minY, limits.maxY);

    img.style.transform = `translate(${nextX}px, ${nextY}px) scale(${zoom})`;
  }

  function onPointerUp(e) {
    if (!isDragging) return;
    e.preventDefault();
    const x = e.clientX || (e.changedTouches && e.changedTouches[0].clientX);
    const y = e.clientY || (e.changedTouches && e.changedTouches[0].clientY);

    let deltaX = x - startX;
    let deltaY = y - startY;

    currentX = clamp(currentX + deltaX, limits.minX, limits.maxX);
    currentY = clamp(currentY + deltaY, limits.minY, limits.maxY);

    isDragging = false;
    telescope.style.cursor = 'grab';
  }

  window.addEventListener('resize', () => {
    limits = updateLimits();
    currentX = clamp(currentX, limits.minX, limits.maxX);
    currentY = clamp(currentY, limits.minY, limits.maxY);
    img.style.transform = `translate(${currentX}px, ${currentY}px) scale(${zoom})`;
  });

  telescope.addEventListener('mousedown', onPointerDown);
  telescope.addEventListener('touchstart', onPointerDown);

  window.addEventListener('mousemove', onPointerMove);
  window.addEventListener('touchmove', onPointerMove);

  window.addEventListener('mouseup', onPointerUp);
  window.addEventListener('touchend', onPointerUp);
  window.addEventListener('touchcancel', onPointerUp);

  img.addEventListener('load', () => {
    limits = updateLimits();
  });

  // Contador
  const contador = document.getElementById('contador');
  const dataInicial = new Date(2025, 1, 1, 0, 0, 0);

  function atualizarContador() {
    const agora = new Date();
    let diff = agora - dataInicial;

    if(diff < 0) {
      contador.textContent = "Ainda nÃ£o chegou a hora...";
      return;
    }

    const segundos = Math.floor(diff / 1000) % 60;
    const minutos = Math.floor(diff / (1000 * 60)) % 60;
    const horas = Math.floor(diff / (1000 * 60 * 60)) % 24;
    const dias = Math.floor(diff / (1000 * 60 * 60 * 24));

    contador.innerHTML = `Fazem <strong>${dias}d ${String(horas).padStart(2,'0')}h ${String(minutos).padStart(2,'0')}m ${String(segundos).padStart(2,'0')}s</strong> que sou o homem mais feliz do universo.`;
  }

  atualizarContador();
  setInterval(atualizarContador, 1000);
</script>

</body>
</html>
